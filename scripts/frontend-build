#!/bin/bash -e

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

. $(dirname "$0")/log

DOCKER_IMAGE=jc21/alpine-nginx-full:node

# Ensure docker exists
if hash docker 2>/dev/null; then
	cd "${DIR}/.."
	log "Building Frontend ..." "info"
	docker run --rm -e CI=true -v "$(pwd)/frontend:/app/frontend" -w /app/frontend "$DOCKER_IMAGE" sh -c "yarn install && yarn build && yarn build && chown -R $(id -u):$(id -g) /app/frontend"
	log "Building Frontend Complete" "success"
else
	log "docker command is not available" "danger"
fi
